Grouping and Having

GROUP BY splits data up into combinations of one or more values

WHERE filters on row values

HAVING appears after the GROUP BY clause and filters on groups or aggregates


SAMPLE
Select nerc_region and the sum of demand_loss_mw for each region.
Exclude values where demand_loss_mw is NULL.
Group the results by nerc_region.
Arrange in descending order of demand_loss.


SELECT nerc_region, sum(demand_loss_mw) AS demand_loss
FROM
grid
WHERE demand_loss_mw IS NOT NULL
GROUP BY nerc_region
ORDER BY demand_loss DESC;


SAMPLE FOR HAVING

WHERE is used to filter rows before any grouping occurs. 
Once you have performed a grouping operation, you may want to further restrict the number of rows returned.
This is a job for HAVING. 
 
 
INSTRUCTION
Modify the provided query to remove the WHERE clause.
Replace it with a HAVING clause so that only results with a total demand_loss_mw of greater than 10000 are returned.

SELECT nerc_region, SUM(demand_loss_mw) AS demand_loss
FROM grid
GROUP BY nerc_region
HAVING SUM(demand_loss_mw) > 10000
ORDER BY demand_loss DESC;
 
 