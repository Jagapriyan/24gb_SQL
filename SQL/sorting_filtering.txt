sorting using ORDER BY

SELECT TOP (5) description,
event_date FROM grid
ORDER BY event_date;


Sorting in descending order using DESC 

SELECT TOP (20) description, 
nerc_region,
event_date
FROM
grid
ORDER BY nerc_region, affected_customers, event_date DESC;


Filtering using WHERE clause

SELECT
description,
event_year
FROM
grid
WHERE description = 'Vandalism';

WHERE Clause with arithmetic expression

SELECT
nerc_region,
demand_loss_mw
FROM
grid
WHERE
affected_customers >= 500000;

WHERE Clause with date filter

SELECT
description,
affected_customers
FROM
grid
WHERE
event_date = '2013-12-22';

WHERE Clause with BETWEEN keyword

SELECT
description,
affected_customers,
event_date
FROM
grid
WHERE
affected_customers BETWEEN 50000 AND 150000
ORDER BY
event_date DESC;

WHERE Clause with NULL and IS NOT NULL

SELECT 
*
FROM
grid
WHERE
demand_loss_mw IS NULL;

SELECT
*
FROM
grid
WHERE
demand_loss_mw IS NOT NULL;


SELECTING SONGS FROM Songlist Use of more WHERE Clause

SELECT
song,
artist,
release_year
FROM
songlist;

no null values in Release year

SELECT 
song,
artist,
release_year
FROM
songlist
WHERE
release_year IS NOT NULL;

order the result by artist and release_year

SELECT
song,
artist,
release_year
FROM
songlist
WHERE 
release_year IS NOT NULL
ORDER BY
artist,release_year;

release_year is greater than or equal to 1980 and less than or equal to 1990

SELECT
song,
artist,
release_year
FROM
songlist
WHERE 
release_year BETWEEN 1980 AND 1990
ORDER BY
artist,release_year;

another method

SELECT
song,
artist,
release_year
FROM
songlist
WHERE 
release_year >= 1980 AND release_year <= 1990
ORDER BY
artist,release_year;

another method

SELECT
song,
artist,
release_year
FROM
songlist
WHERE 
(release_year >= 1980 OR release_year <= 1990)
ORDER BY
artist,release_year;

Select all artists beginning with B who released tracks in 1986, but also retrieve any records where the release_year is greater than 1990. 

SELECT
artist,
release_year,
song
FROM
songlist
WHERE
(
artist LIKE 'B%' 
AND
release_year = 1986
)
OR
release_year > 1990
ORDER BY
release_year,
artist,
song;


Aggregating data

sum

Obtaining grand total of demand_loss_mw column. only retrieve rows where demand_loss_is not NULL and nerc_region is 'MRO'

SELECT
SUM (demand_loss_mw) AS MRO_demand_loss
FROM
grid
WHERE
demand_loss_mw IS NOT NULL 
AND
nerc_region = 'MRO';


count

return count of grid_id coumn for nerc_region RFC

SELECT
COUNT (grid_id) AS RFC_COUNT
FROM
grid
WHERE
nerc_region = 'RFC';

find the minimum value from the affected_customers column, but only for rows where demand_loss_mw has a value. name the result as min_affected_customers

SELECT
MIN(affected_customers) AS min_affected_customers
FROM
grid
WHERE
demand_loss_mw IS NOT NULL;

